# Malware Analysis – Dissecting PDF file

#### Abstract

*There are a large number of cyber threats today, many of these cyber threats can be based on malicious code, one of this code is known as Malware (Malicious Software or maldoc - Malicious Document ) to refer these kind of threats. The term Malware, is a generic term that covers all types of programs specifically developed to perform malicious actions on a computer, thus the term malware has become the name for any type of program specifically developed to perform harmful actions and malicious activities on a compromised system. 
This paper presents an in-depth security analysis of the PDF features and capabilities, independently from any vulnerability. The aim is to exhaustively explore and evaluate the risk attached to PDF language-based malware which could successfully using different techniques in malware-based in PDF embedded. You’ll have the experience of understanding different kind of structures in the binaries as PDF such as header/ body/cross-reference table/trailer, explaining how each session works within a binary, what are the techniques used such as obfuscation, encodings with JavaScript (PDF) and more, demonstrating as a is the action of these malwares and where it would be possible to "include" a malicious code. By the end of this article it will be clear to everyone, how we got find C&C ( Command Control) in binaries structures, how can the researcher should conduct each of these kind of analyses, it should seek more basic knowledge, with file structures, software architecture and programming language*

*Keywords: MalwareAnalysis, Maldoc, MaliciousPDF* 

============================================================================

# 1	Introduction

  Over the past few years, different technologies have been developed to provide cybersecurity, however, when you look at incident indicators from different sources, you see that the number of incidents within information technology grows every year, always motivated by different types of threat using different kind of artifacts.
  Due to the large number of these artifacts, some organizations and security companies use automated or semi-automated analysis methods. Knowing how malicious code works is the basis for producing efficient detection and protection tools, as it allows you to know the context that the malware intends to reach, understanding the target audience of the threat, the information collected, the use and the destination of this malware.
  However, the time to find the defenses has not been consistent with the current attack scenario, which is extremely unfavorable for the end user. With this motivation, researchers have shown themselves willing to face the problem and confident in proposing solutions that make the processes, both of analysis and detection, efficient and reliable.
  It is worth noting that, in cases involving financial fraud and identity theft, knowing the performance of the malware is paramount to eradicate the incident. The simple discovery of malicious codes may suggest a preventive action in relation, for example, to prevent a user from having access to a system, as it is not possible to guarantee that that user is correctly recognized, as the compromise of his identification information does risk of fraud becoming high.
  A major problem faced in these situations is to determine the type of compromise, that is, to identify the real ability that malware has to capture information. This factor determines the response time that the organization and security companies have to produce a malware recognition signature.
  Artifact analysis has different applications, it can be used to help understand a particular artifact, be it malware or maldoc that was identified in an incident, or that was received via phishing or even sent by someone to some security research group to evaluate.
  The analysis of the artifact is a necessary process to build intelligence on cyber threats, because through this intelligence it is possible to evaluate the effectiveness of security controls, whether they are methodological or based on some tool. This continuous improvement approach based on built intelligence is what really makes it possible to increase cyber resilience.
When we talk about Malware Analysis, we can say that they are based on two forms of analysis, known as Static Analysis and Dynamic Analysis.





![connect_box_1_modem](https://user-images.githubusercontent.com/31785433/71375371-48959d00-25be-11ea-99fc-6b23375f89c6.png)



============================================================================

The purpose of this exploration is to validate the security applied to the standard implementation of the router, as well as to guarantee the application of the main security models, whether in a home user or in a corporate environment.


**Victim 1**

![Victim1](https://user-images.githubusercontent.com/31785433/71374644-bf7d6680-25bb-11ea-853f-44db27933398.png)

**Victim 2**

![Victim2](https://user-images.githubusercontent.com/31785433/71374789-534f3280-25bc-11ea-86a0-b6b16735e8c9.png)


**PoC in Video**

In this video below, We can see the all Attacker Machine using **Wireshark** to sniff the network, we realize two attempts to login in Administration page.

[![Access](https://i.vimeocdn.com/filter/overlay?src0=https%3A%2F%2Fi.vimeocdn.com%2Fvideo%2F841858314_1280x720.jpg&src1=https%3A%2F%2Ff.vimeocdn.com%2Fimages_v6%2Fshare%2Fplay_icon_overlay.png)](https://vimeo.com/381213952)


**Manufacturer**

After discovering this flaw, we communicated(31/12/2020) the manufacturer about it, which put us in contact with the development team to assist in the improvement process (27/01/2020)
LASTUPDATE - 24/02/2020 by Manufacture
"What I can tell you is that this issue was discovered previously...but is hard to say when this will be fixed as the real vulnerability of this risk is very low"

**Publications** 

https://pentestmag.com/product/pentest-build-your-own-pentest-lab-in-2020/

https://www.linkedin.com/feed/update/urn:li:activity:6633366352042307585/


**References** 

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19967 

https://nvd.nist.gov/vuln/detail/CVE-2019-19967 

https://github.com/filipi86/ConnectBoxDOCSIS-3.0 

RFC 2660 - https://tools.ietf.org/html/rfc2660 

RFC 7231 - https://tools.ietf.org/html/rfc7231 

RFC 2818 - https://tools.ietf.org/html/rfc2818 

RFC 2612 - https://tools.ietf.org/html/rfc2616 

http://cwe.mitre.org/data/definitions/319.html 

Official Document form UPC  -  https://www.upc.ch/pdf/support/manuals/en/internet/ConnectBox/connect-box-manual.pdf  


